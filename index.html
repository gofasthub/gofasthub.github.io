<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>gofasthub</title>
  <link rel="icon" href="fasthublogo.png" />
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@400;600;700&display=swap');
    :root {
      --accent: #a06bff;
      --radius: 18px;
      --glass-bg: rgba(255,255,255,0.08);
      font-family: 'Outfit', sans-serif;
    }
    * { margin:0; padding:0; box-sizing:border-box }
    body {
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      background:linear-gradient(135deg,#8a6bff,#6ca3ff,#c78cff);
      background-size:400% 400%;
      animation:gradientShift 12s ease infinite;
      color:#fff;
      overflow:hidden;
    }
    @keyframes gradientShift {
      0% {background-position:0% 50%} 50%{background-position:100% 50%} 100%{background-position:0% 50%}
    }
    .liquidGlass {
      backdrop-filter: blur(10px) saturate(180%);
      background: var(--glass-bg);
      border-radius: var(--radius);
      border: 1px solid rgba(255,255,255,0.18);
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
      transition: all 0.3s ease;
    }
    .centerWrap {
      position:fixed; top:50%; left:50%;
      transform:translate(-50%,-50%);
      display:flex; flex-direction:column; align-items:center; justify-content:center;
      width:100%; max-width:720px; gap:24px; padding:20px;
      animation: fadeIn .6s ease-out forwards;
    }
    @keyframes fadeIn {from{opacity:0;transform:translate(-50%,-46%) scale(.95)}to{opacity:1;transform:translate(-50%,-50%) scale(1)}}
    input[type=password],input[type=text],input[type=number]{width:100%;padding:12px;border:none;border-radius:12px;background:rgba(255,255,255,0.1);color:#fff;margin-bottom:10px}
    input:focus{outline:none;background:rgba(255,255,255,0.2)}
    .games-page{display:none;width:100%;max-width:720px;animation:fadeIn .6s ease-out forwards}
    .games-page.active{display:block}
    .games-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:18px;margin-top:18px}
    .game-card{overflow:hidden;border-radius:12px;height:170px;cursor:pointer;display:flex;flex-direction:column;transition:transform .3s}
    .game-card:hover{transform:scale(1.05)}
    .game-card img{width:100%;height:70%;object-fit:cover}
    .game-card span{padding:8px;text-align:center;background:rgba(0,0,0,0.18);text-transform:uppercase;font-weight:600;font-size:0.9rem}
    .admin-popup-button{position:fixed;right:14px;bottom:14px;padding:8px 10px;border-radius:12px;background:rgba(255,255,255,0.06);border:1px solid rgba(255,255,255,0.12);cursor:pointer;color:#fff}
    .admin-password-popup,.admin-panel{position:fixed;right:14px;bottom:60px;width:320px;padding:14px;gap:10px;display:none;flex-direction:column}
    .notification-container{position:fixed;top:22px;left:50%;transform:translateX(-50%);display:flex;flex-direction:column;gap:10px;z-index:100}
    .notification{padding:12px 18px;border-radius:12px;min-width:220px;text-align:center;animation:bumpIn .4s forwards}
    @keyframes bumpIn{0%{transform:translateY(-10px) scale(.9);opacity:0}100%{transform:translateY(0) scale(1);opacity:1}}
    .events-stack{position:fixed;left:14px;bottom:14px;display:flex;flex-direction:column;gap:10px;z-index:72}
    .event-pill{display:flex;align-items:center;gap:10px;padding:10px 12px;border-radius:12px;background:rgba(0,0,0,0.14)}
    .event-pill span{font-size:1.5rem}
    .taco{position:fixed;font-size:2rem;pointer-events:none;animation:fall 4s linear infinite;z-index:80}
    @keyframes fall{0%{transform:translateY(-10vh) rotate(0)}100%{transform:translateY(110vh) rotate(360deg)}}
  </style>
</head>
<body>
  <div class="centerWrap">
    <div class="liquidGlass" id="login-card" style="padding:28px;text-align:center;">
      <div style="font-size:1.9rem;font-weight:700;">welcome to fasthub</div>
      <input id="password" type="password" placeholder="enter access key"/>
      <div id="error-msg" style="color:#ffb3b3;height:18px;margin-top:6px"></div>
    </div>

    <div class="liquidGlass games-page" id="games-page">
      <h2 style="font-size:1.8rem;text-align:center;">welcome to fasthub</h2>
      <div class="games-grid">
        <div class="liquidGlass game-card" onclick="openGame('https://ubg742.github.io/egycr/index.html')">
          <img src="eggycarbanner.png" alt="eggy car"/><span>eggy car</span>
        </div>
      </div>
    </div>
  </div>

  <button class="liquidGlass admin-popup-button" id="adminToggleBtn">admin</button>
  <div class="liquidGlass admin-password-popup" id="admin-password-popup">
    <input id="adminPass" type="password" placeholder="enter admin password"/>
    <button class="liquidGlass" id="unlockBtn">unlock admin panel</button>
  </div>

  <div class="liquidGlass admin-panel" id="admin-panel">
    <h3>global message</h3>
    <input id="adminMessage" type="text" placeholder="Type global message"/>
    <input id="duration" type="number" placeholder="Duration (s)" min="1"/>
    <button class="liquidGlass" id="sendBtn">Send Message</button>
    <hr style="opacity:.08;margin:8px 0;">
    <h3>global event</h3>
    <select id="eventSelect">
      <option value="tacos">ðŸŒ® Raining Tacos</option>
      <option value="doublexp">âš¡ Double XP</option>
    </select>
    <input id="eventDuration" type="number" placeholder="Event duration (s)" min="5"/>
    <button class="liquidGlass" id="startEventBtn">Start Event</button>
  </div>

  <div class="notification-container" id="notificationContainer"></div>
  <div class="events-stack" id="eventsStack"></div>

  <!-- Firebase + site logic -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
    import { getDatabase, ref, set, push, onValue } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-database.js";

    // âœ… Your Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyDJskELwuyHZVcFZXSX0QHU3e2UgTcRyLQ",
      authDomain: "fasthub-messages.firebaseapp.com",
      databaseURL: "https://fasthub-messages-default-rtdb.firebaseio.com",
      projectId: "fasthub-messages",
      storageBucket: "fasthub-messages.firebasestorage.app",
      messagingSenderId: "788670666897",
      appId: "1:788670666897:web:223bb6a9f8bff4af444730",
      measurementId: "G-8DN5YXWV0V"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    // Password logic
    const passwordInput=document.getElementById("password");
    const errorMsg=document.getElementById("error-msg");
    const loginCard=document.getElementById("login-card");
    const gamesPage=document.getElementById("games-page");
    const sitePassword="fast67";
    const adminPassword="fastadmin67";

    passwordInput.addEventListener("keyup",e=>{
      if(e.key==="Enter"){
        if(passwordInput.value===sitePassword){loginCard.style.display="none";gamesPage.style.display="block";}
        else errorMsg.textContent="incorrect password";
      }
    });

    // Admin popup
    const adminBtn=document.getElementById("adminToggleBtn");
    const adminPopup=document.getElementById("admin-password-popup");
    const adminPanel=document.getElementById("admin-panel");
    adminBtn.onclick=()=>{adminPopup.style.display=adminPopup.style.display==="flex"?"none":"flex";adminPopup.style.flexDirection="column";}
    document.getElementById("unlockBtn").onclick=()=>{
      if(document.getElementById("adminPass").value===adminPassword){
        adminPopup.style.display="none";adminPanel.style.display="flex";adminPanel.style.flexDirection="column";
      }else alert("Incorrect admin password");
    };

    function openGame(url){
      const newWin=window.open("about:blank","_blank");
      newWin.document.write(`<iframe src="${url}" frameborder="0" style="width:100%;height:100vh;"></iframe>`);
    }

    const notificationContainer=document.getElementById("notificationContainer");
    const eventsStack=document.getElementById("eventsStack");

    // Send global message
    document.getElementById("sendBtn").onclick=()=>{
      const msg=document.getElementById("adminMessage").value.trim();
      const dur=parseInt(document.getElementById("duration").value);
      if(!msg||!dur)return;
      push(ref(db,"global/messages"),{msg,duration:dur,timestamp:Date.now()});
    };

    // Start global event
    document.getElementById("startEventBtn").onclick=()=>{
      const event=document.getElementById("eventSelect").value;
      const dur=parseInt(document.getElementById("eventDuration").value);
      push(ref(db,"global/events"),{event,duration:dur,timestamp:Date.now()});
    };

    // Listen for global messages
    onValue(ref(db,"global/messages"),snap=>{
      const data=snap.val(); if(!data)return;
      const latest=Object.values(data).slice(-1)[0];
      showMessage(latest.msg,latest.duration);
    });

    // Listen for global events
    onValue(ref(db,"global/events"),snap=>{
      const data=snap.val(); if(!data)return;
      const latest=Object.values(data).slice(-1)[0];
      startEvent(latest.event,latest.duration);
    });

    function showMessage(msg,duration){
      const note=document.createElement("div");
      note.className="liquidGlass notification";
      note.textContent=msg;
      notificationContainer.appendChild(note);
      setTimeout(()=>note.remove(),duration*1000);
    }

    function startEvent(event,duration){
      const pill=document.createElement("div");
      pill.className="event-pill liquidGlass";
      let emoji=event==="tacos"?"ðŸŒ®":"âš¡";
      pill.innerHTML=`<span>${emoji}</span><div class="timer">${formatTime(duration)}</div>`;
      eventsStack.appendChild(pill);
      const timer=pill.querySelector(".timer");
      let t=duration;
      const interval=setInterval(()=>{
        t--; timer.textContent=formatTime(t);
        if(t<=0){clearInterval(interval);pill.remove();}
      },1000);
      if(event==="tacos")spawnTacos(duration);
    }

    function formatTime(sec){const m=Math.floor(sec/60);const s=sec%60;return `${m}:${s.toString().padStart(2,"0")}`}
    function spawnTacos(duration){
      const end=Date.now()+duration*1000;
      const loop=()=>{
        if(Date.now()>end)return;
        const taco=document.createElement("div");
        taco.className="taco"; taco.textContent="ðŸŒ®";
        taco.style.left=Math.random()*100+"%";
        document.body.appendChild(taco);
        setTimeout(()=>taco.remove(),4000);
        requestAnimationFrame(loop);
      }; loop();
    }
  </script>
</body>
</html>
